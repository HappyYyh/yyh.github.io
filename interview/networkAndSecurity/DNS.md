---
title: DNS
permalink: /interview/networkAndSecurity/DNS
key: networkAndSecurity-DNS
---

### 【DNS解析过程】

详情查看[URL请求过程](/interview/networkAndSecurity/URL.html)

DNS域名解析的请求过程分为以下几步:

1. 检查浏览器缓存中是否有这个域名对应的解析过的IP地址
2. 检查操作系统缓存中是否有这个域名对应的解析结果
3. 向本地服务器查询(LDNS)
4. LDNS没有命中，直接到Root Server域名服务器请求解析
5. 根域名服务器返回给本地域名服务器一个所查询域的主域名服务器（gTLD Server)地址
6. 本地域名服务器再向上一步返回的gTLD服务器发送请求
7. 接受请求的顶级域名服务器查询并返回此域名对应的权威服务器(Name Server)
8. 权威服务器会查询存储的域名和IP的映射关系表并返回
9. 把解析的结果返回给用户，用户根据TTL值缓存在本地系统缓存中，域名解析过程结束



### 【DNS端口】

**概念**

> DNS端口号是[域名系统](https://baike.baidu.com/item/域名系统/2251573) (Domain Name System) 的缩写，该系统用于命名组织到域[层次结构](https://baike.baidu.com/item/层次结构/7658029)中的计算机和网络服务。在Internet上域名与IP地址之间是一一对应的，域名虽然便于人们记忆，但机器之间只能互相认识IP地址，它们之间的转换工作称为域名解析，域名解析需要由专门的域名解析服务器来完成。 ——[百度百科](https://baike.baidu.com/item/dns%E7%AB%AF%E5%8F%A3%E5%8F%B7/10411070?fr=aladdin)

**作用**

> **DNS**协议运行在**UDP**协议之上，使用**端口号**53。在[传输层](https://baike.baidu.com/item/传输层)TCP提供端到端可靠的服务,在UDP端提供尽力交付的服务。其[控制端口](https://baike.baidu.com/item/控制端口)作用于UDP端口53。



### 【DNS和Hosts】

**共同点**： 都是做域名解析的，解决IP地址与域名的对应关系问题。

**不同点：**

- **Hosts**

  **特点**：

  在对域名解析的时候， 计算机会优先查看本地的HOSTS文件（C:\Windows\System32\drivers\etc\hosts）中是否存在相应的域名解析记录。如果存在则返回域名对应的IP地址，如果不存在则在通过DNS来查到该域名对应的IP地址。

  **优点：**

  1. 速度快 （由于是本地的，不通过网络，查询速度较快）

  2. 属于主动解析 （它能将域名强制的指向我们期望它解析到的那个IP地址）

  **缺点：**

  1. 维护比较麻烦（当域名解析记录更新或者有新的域名解析记录的时候， 需要我们更新所有计算机的HOSTS文件）

  2. 存在安全问题（如中电脑病毒情况下，可能会恶意修改HOSTS文件）

  **应用场景：**

  1. 适用于小型公司局域网或本地的域名解析工作。

  2. 当DNS服务器解析出错的时候，可以通过临时修改HOSTS文件来解决域名解析问题。

  3. 通过修改HOSTS文件，添加相应的记录，可以达到屏蔽广告的效果。

  4. 早期的时候可以通过修改HOSTS文件，上google网站。现在该方法应该是无效的了

- **DNS**

  **特点**： 

  管理海量域名解析工作，为广大互联网用户提供服务。

  **优点**：

  1. 维护工作量降低（原先是维护每台计算机的HOSTS文件，现在只需要维护DNS服务器即可）

  2. 提供统一的服务，相对较安全（通过DNS服务器解析到的IP地址，一般都是我们期望的）

  **缺点**： 

  1. 解析速度慢（尽管DNS有缓存机制，但相对HOSTS文件而已，速度还是慢了一点）

  2. 存在一定风险（在内网环境，如果主、从DNS服务器都挂了且没有备机的情况，将无法完成域名的解析工作）

  **应用场景**： 

  1. 适用于大型互联网或中大型公司局域网DNS的解析工作。

  2. 可以用作反垃圾邮件以及安全防护等



### 【ARP协议】

**概念：**

ARP协议是`“Address Resolution Protocol”`（地址解析协议）的缩写。其作用是在以太网环境中，数据的传输所依懒的是MAC地址而非IP地址，而将已知IP地址转换为MAC地址的工作是由ARP协议来完成的。



### 【网络延迟大的情况怎么处理】 

更改DNS服务器